# ğŸ’š 1038. ç­‰è…°ç›´è§’ä¸‰è§’å½¢

**å•ç‚¹æ—¶é™:** 2.0 sec

**å†…å­˜é™åˆ¶:** 512 MB

åœ¨ä¸€ä¸ªç”±æ­£æ•´æ•°æ„æˆçš„çŸ©é˜µä¸­ï¼Œç»Ÿè®¡æœ‰å¤šå°‘ä¸ªç­‰è…°ç›´è§’ä¸‰è§’å½¢èŒƒå›´å†…çš„æ•°å€¼ä¹‹å’Œå¤§äºç­‰äº $$k$$ ï¼Œ å…¶ä¸­ç­‰è…°ç›´è§’ä¸‰è§’å½¢çš„ä¸¤ä¸ªç›´è§’è¾¹è·ŸçŸ©é˜µè¾¹ç•Œå¹³è¡Œï¼Œç›´è§’è¾¹çš„é•¿åº¦è‡³å°‘ä¸º2ï¼Œç›´è§’æœå‘ä¸é™ï¼ˆå…±æœ‰4ç§æ–¹å‘ï¼‰ã€‚

ä¾‹å¦‚ä¸‹å›¾ä¸­çš„ç°è‰²åŒºåŸŸéƒ½ç®—ä¸€ä¸ªç­‰è…°ç›´è§’ä¸‰è§’å½¢ã€‚\


![](https://acm.ecnu.edu.cn/upload/4209/4209\_p1.NgfRbYLk.png)

### è¾“å…¥æ ¼å¼

ç¬¬ä¸€è¡Œä¸‰ä¸ªç”¨ç©ºæ ¼éš”å¼€çš„æ­£æ•´æ•°å’Œ$$n,m$$å’Œ$$k$$ ï¼Œå…¶ä¸­ $$n$$ å’Œ $$m$$ è¡¨ç¤ºçŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°ï¼Œ$$(0<n,m<200)$$ ï¼Œk ä¸ºé¢˜æ„ä¸­çš„ k,(0\<k<105)ã€‚

æ¥ä¸‹æ¥ $$n$$ è¡Œï¼Œæ¯è¡ŒåŒ…æ‹¬$$m$$ ä¸ªç”¨ç©ºæ ¼éš”å¼€çš„æ­£æ•´æ•°$$x_{ij}$$ ï¼Œè¡¨ç¤ºçŸ©é˜µä¸­çš„æ•°å€¼ï¼Œ$$(0<x_{ij}<1000)$$ ã€‚

### è¾“å‡ºæ ¼å¼

è¾“å‡ºä¸€è¡Œï¼ŒåŒ…å«ä¸€ä¸ªæ•´æ•°$$s$$ï¼Œè¡¨ç¤ºæœ‰ $$s$$ ä¸ªç­‰è…°ç›´è§’ä¸‰è§’å½¢èŒƒå›´å†…çš„æ•°å€¼ä¹‹å’Œå¤§äºç­‰äº$$k$$ ã€‚

### æ ·ä¾‹

{% tabs %}
{% tab title="æ ·ä¾‹1" %}
{% code title="input" %}
```
2 2 6
2 3
1 2
```
{% endcode %}

{% code title="output" %}
```
3
```
{% endcode %}
{% endtab %}

{% tab title="Second Tab" %}
{% code title="input" %}
```
2 3 6
1 2 3
3 2 1
```
{% endcode %}

{% code title="output" %}
```
6
```
{% endcode %}
{% endtab %}
{% endtabs %}

{% hint style="info" %}
æ•°æ®èŒƒå›´ï¼š

æœ‰ 20% çš„æ•°æ®ä¿è¯ $$n,m<10$$\
å…¶ä½™ 80% çš„æ•°æ®ä¿è¯ $$n,m<200$$
{% endhint %}

### é¢˜è§£

{% code lineNumbers="true" %}
```c
#include <stdio.h> 

typedef long long int lli;
typedef struct{
	lli SumOfColumn;
	lli SumOfMatrix;
}Block;

int main(void)
{
	int n, m, k;
	lli temp, cnt = 0;
	scanf("%d %d %d", &n, &m, &k);
	Block in[n][m];
	for(int i = 0 ; i < n ; i ++){
		for(int j = 0 ; j < m ; j ++){
			scanf("%lld", &temp);
			if(i == 0){
				in[i][j].SumOfColumn = temp;
			}else{
				in[i][j].SumOfColumn = temp + in[i - 1][j].SumOfColumn;
			}
			if(i == 0 && j == 0){
				in[i][j].SumOfMatrix = temp;
			}else if(i == 0){
				in[i][j].SumOfMatrix = in[i][j - 1].SumOfMatrix + temp;
			}else if(j == 0){
				in[i][j].SumOfMatrix = in[i - 1][j].SumOfMatrix + temp;
			}else{
				in[i][j].SumOfMatrix = in[i - 1][j].SumOfMatrix + in[i][j - 1].SumOfMatrix - in[i - 1][j - 1].SumOfMatrix + temp;
			}
		}
	}
	lli area, LargeRect;
	for(int i = 0 ;i < n ; i ++){
		for(int j = 0 ; j < m ; j ++){
			for(int t = 0; i + t < n && j + t < m; t ++){
				area = LargeRect = 0;
				for(int r = i + t, c = j; r >= i &&  c <= j + t; r --, c ++){
					if(i == 0){
						area += in[r][c].SumOfColumn;
					}else{
						area += (in[r][c].SumOfColumn - in[i - 1][c].SumOfColumn);
					}				
				}
				if(area >= k && t != 0){ cnt ++;}
				if(i + t < n - 1 && j + t < m - 1){
					if(i == 0 && j == 0){
						LargeRect = in[i + t + 1][j + t + 1].SumOfMatrix;
					}else if(i == 0){
						LargeRect = in[i + t + 1][j + t + 1].SumOfMatrix - in[i + t + 1][j - 1].SumOfMatrix;
					}else if(j == 0){
						LargeRect = in[i + t + 1][j + t + 1].SumOfMatrix - in[i - 1][j + t + 1].SumOfMatrix;
					}else{
						LargeRect = in[i + t + 1][j + t + 1].SumOfMatrix - in[i + t + 1][j - 1].SumOfMatrix - in[i - 1][j + t + 1].SumOfMatrix + in[i - 1][j - 1].SumOfMatrix;
					}
					if(LargeRect - area >= k){ cnt ++;}
				}
			}
			
			for(int t = 0; i + t < n && j - t >= 0; t ++){
				area = LargeRect = 0;
				for(int r = i + t, c = j; r >= i &&  c >= j - t; r --, c --){
					if(i == 0){
						area += in[r][c].SumOfColumn;
					}else{
						area += (in[r][c].SumOfColumn - in[i - 1][c].SumOfColumn);
					}				
				}
				if(area >= k && t != 0){ cnt ++;}
				if(i + t < n - 1 && j - t > 0){
					if(i == 0 && j - t - 1 == 0){
						LargeRect = in[i + t + 1][j].SumOfMatrix;
					}else if(i == 0){
						LargeRect = in[i + t + 1][j].SumOfMatrix - in[i + t + 1][j - t - 2].SumOfMatrix;
					}else if(j - t - 1 == 0){
						LargeRect = in[i + t + 1][j].SumOfMatrix - in[i - 1][j].SumOfMatrix;
					}else{
						LargeRect = in[i + t + 1][j].SumOfMatrix - in[i + t + 1][j - t - 2].SumOfMatrix - in[i - 1][j].SumOfMatrix + in[i - 1][j - t - 2].SumOfMatrix;
					}
					if(LargeRect - area >= k){ cnt ++;}							
				}
			}
		}
	}
	
	printf("%llu", cnt);
	
	return 0;
}
```
{% endcode %}
